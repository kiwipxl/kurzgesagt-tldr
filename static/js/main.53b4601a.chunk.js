(this["webpackJsonpkurzgesagt-tldr"]=this["webpackJsonpkurzgesagt-tldr"]||[]).push([[0],{58:function(e,t,a){},59:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var c=a(2),s=a(1),n=a.n(s),i=a(17),r=a.n(i),d=(a(58),a(7)),l=a(8),o=a(19),j=(a(59),function(e){return e.setHeaderOptions(!1),Object(c.jsx)("div",{className:"content-container",children:Object(c.jsx)("div",{className:"content",children:e.children})})}),u=a(26),h=a(15),b=function(e){var t=Object(l.g)();return Object(c.jsxs)(h.a,{variant:"pills",onSelect:function(a){t.replace("/video/".concat(e.videoId,"#").concat(a)),e.onClickTab&&e.onClickTab(a)},activeKey:e.tab||"",defaultActiveKey:e.defaultTab,children:[Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:"video",children:"Video"})}),Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:"sources",disabled:!e.hasSources,children:"Sources"})}),Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:"transcript",disabled:!e.hasTranscript,children:"Transcript"})}),Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:"tags",disabled:!e.hasTags,children:"Tags"})}),Object(c.jsx)(h.a.Item,{children:Object(c.jsx)(h.a.Link,{eventKey:"soundtrack",disabled:!e.hasSoundTrack,children:"Soundtrack"})})]})},O=a(6),f=a(25),x=a.n(f),v=a(20),m=function(e){if(!e.timestampMillis)return null;var t=v.DateTime.fromMillis(parseInt(e.timestampMillis)).toRelative();return Object(c.jsx)("span",{className:"last-updated",children:"Last updated "+t})},p=function(e){return Object(c.jsxs)("div",{children:[Object(c.jsx)(O.a,{className:"video-details-card",children:Object(c.jsx)(O.a.Body,{children:Object(c.jsx)("div",{children:x()(e.transcript.replaceAll("\n","<br/>"))})})}),Object(c.jsx)(m,{timestampMillis:e.lastUpdated})]})},g=a(22),w=a(11),k=a.n(w),N=[k()("#8dd3c7"),k()("#ffffb3"),k()("#bebada"),k()("#fb8072"),k()("#80b1d3"),k()("#fdb462"),k()("#b3de69"),k()("#fccde5"),k()("#d9d9d9"),k()("#bc80bd"),k()("#ccebc5"),k()("#ffed6f")];function y(e){var t,a=0;for(t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t),a|=0;return N[Math.abs(a)%N.length]}var S=function(e){var t,a=[],s=0,n=0,i=Object(g.a)(e.sources.keyPoints);try{for(i.s();!(t=i.n()).done;){var r=t.value,d=[];d.push(Object(c.jsx)("h4",{children:r.title}));var l,o=Object(g.a)(r.content);try{for(o.s();!(l=o.n()).done;){var j=l.value;switch(j.type){case"text":d.push(Object(c.jsx)("p",{children:j.data}));break;case"citation":var u=/(http[s]?:\/\/)?(www\.)?([a-zA-Z0-9\.-]+)\//g.exec(j.data.url),h=null;if(u){var b=u[3],f=y(b),x=k()(f).darken(),v=k()(f).darken(2);f=f.alpha(.5),h=Object(c.jsx)("a",{className:"sources-domain-tag",href:"http://"+b,target:"_blank",style:{backgroundColor:f.hex(),borderColor:x.hex(),color:v.hex()},children:b})}d.push(Object(c.jsxs)("span",{className:"citation-link",children:[Object(c.jsx)("span",{className:"sources-number",children:n+1+"."}),Object(c.jsx)("a",{href:j.data.url,target:"_blank",children:j.data.title?j.data.title:j.data.url}),h]})),d.push(Object(c.jsx)("br",{})),d.push(Object(c.jsx)("span",{className:"sources-quote",children:j.data.quote})),d.push(Object(c.jsx)("p",{})),++n}}}catch(p){o.e(p)}finally{o.f()}a.push(Object(c.jsx)("div",{className:"sources-key-point",children:d},s)),++s}}catch(p){i.e(p)}finally{i.f()}return Object(c.jsxs)("div",{children:[Object(c.jsx)(O.a,{className:"video-details-card",children:Object(c.jsxs)(O.a.Body,{children:[Object(c.jsxs)("p",{className:"info-box",children:["This section is the citations and further reading provided by Kurzgesagt at",Object(c.jsx)("a",{href:e.sources.url,target:"_blank",children:" "+e.sources.url})]}),a]})}),Object(c.jsx)(m,{timestampMillis:e.lastUpdated})]})},C=function(e){return Object(c.jsxs)("div",{children:[Object(c.jsx)(O.a,{className:"video-details-card",children:Object(c.jsx)(O.a.Body,{children:Object(c.jsx)("div",{className:"chip-grid",children:e.tags.map((function(e){return Object(c.jsx)("div",{className:"chip",children:e},e)}))})})}),Object(c.jsx)(m,{timestampMillis:e.lastUpdated})]})},T=a(48),B=a.n(T);var H=function(e){var t,a=n.a.useState(0),s=Object(d.a)(a,2),i=s[0],r=s[1],l=n.a.useRef(null),o=new ResizeObserver((function(e){r(e[0].target.clientWidth/(16/9))}));return n.a.useEffect((function(){o.observe(l.current)}),[]),Object(c.jsxs)("div",{children:[Object(c.jsxs)(O.a,{className:"video-details-card",children:[Object(c.jsx)("div",{ref:l,className:"youtube-player",children:Object(c.jsx)(B.a,{width:"100%",height:i,url:"https://www.youtube.com/watch?v=".concat(e.id)})}),Object(c.jsx)(O.a.Body,{children:(t=e.description,t=(t=(t=(t=t.replaceAll("\n","\n")).replaceAll(/(.+)/g,(function(e,t){return"<span>".concat(t,"</span>")}))).replaceAll(/(http[s]?:\/\/[a-zA-Z0-9\-\_\*\?\=\&\.\/]+)([ \\n]?)/g,(function(e,t,a){return'<a href="'.concat(t,'" target="_blank">').concat(t,"</a>")+a}))).replaceAll("\n","<br/>"),x()(t))})]}),Object(c.jsx)(m,{timestampMillis:e.lastUpdated})]})},M=a(49),U=a.n(M),A=function(e){var t=n.a.useState(0),a=Object(d.a)(t,2),s=a[0],i=a[1],r=n.a.useRef(null),l=new ResizeObserver((function(e){i(Math.min(e[0].target.clientWidth/(16/9),280))}));return n.a.useEffect((function(){r.current&&l.observe(r.current)}),[]),Object(c.jsxs)("div",{children:[Object(c.jsx)(O.a,{className:"video-details-card",children:Object(c.jsx)(O.a.Body,{children:Object(c.jsx)("div",{ref:r,children:Object(c.jsx)(U.a,{width:"100%",height:s,url:e.url})})})}),Object(c.jsx)(m,{timestampMillis:e.lastUpdated})]})},E=function(e){return Object(c.jsx)(O.a,{className:"video-details-card",children:Object(c.jsx)(O.a.Body,{children:Object(c.jsxs)("div",{className:"missing-details",children:["No ",e.tab," could be found for this video. :("]})})})},I="http://192.168.43.58:7800",V=a(18),L=function(e){var t=n.a.useState(!1),a=Object(d.a)(t,2),s=a[0],i=a[1];return Object(c.jsxs)(V.a,{variant:"danger",children:[e.title&&Object(c.jsx)(V.a.Heading,{children:e.title}),e.message&&Object(c.jsx)("p",{children:e.message}),s&&Object(c.jsxs)("div",{children:[Object(c.jsx)("hr",{}),Object(c.jsx)("p",{children:e.details}),Object(c.jsx)("a",{className:"error-toggle-details",onClick:function(){return i(!1)},children:"Show less details"})]}),!s&&Object(c.jsx)("a",{className:"error-toggle-details",onClick:function(){return i(!0)},children:"Show more details"})]})};function z(e){Object(l.g)();return Object(c.jsxs)("div",{className:"content-container",children:[!e.noContentBox&&Object(c.jsx)("div",{className:"content",children:e.children}),e.noContentBox&&Object(c.jsx)("div",{children:e.children})]})}var R=function(e){var t=Object(l.h)().videoId,a="video",s=n.a.useState(a),i=Object(d.a)(s,2),r=i[0],o=i[1],j=n.a.useState({}),h=Object(d.a)(j,2),O=h[0],f=h[1],x=n.a.useState(!0),v=Object(d.a)(x,2),m=v[0],g=v[1],w=n.a.useState(),k=Object(d.a)(w,2),N=k[0],y=k[1];if(e.setHeaderOptions(!0),""!==window.location.hash){var T=window.location.hash.replace("#","");T!==r&&o(T)}if(n.a.useEffect((function(){fetch("".concat(I,"/video/").concat(t)).then((function(e){return e.json()})).then((function(e){f(e),g(!1)})).catch((function(e){console.error("failed to fetch video details for ".concat(t),e),y(e)}))}),[]),N)return Object(c.jsx)(z,{noContentBox:!0,children:Object(c.jsx)(L,{title:"There was an error while fetching video details!",details:N.message})});if(m)return Object(c.jsx)(z,{children:Object(c.jsx)("div",{className:"center",children:Object(c.jsx)(u.a,{animation:"border",role:"status",children:Object(c.jsx)("span",{className:"sr-only",children:"Loading..."})})})});var B=void 0!=O.sources,M=void 0!=O.transcript&&void 0!=O.transcript.en,U=void 0!=O.info.soundtrack,V=void 0!=O.tags,R=null;switch(r){case"video":R=Object(c.jsx)(H,{id:O.info.id,description:O.info.description,lastUpdated:O.info.last_scraped});break;case"sources":R=B?Object(c.jsx)(S,{sources:O.sources,lastUpdated:O.sources.last_updated}):Object(c.jsx)(E,{tab:r});break;case"transcript":R=M?Object(c.jsx)(p,{transcript:O.transcript.en,lastUpdated:O.transcript.last_updated}):Object(c.jsx)(E,{tab:r});break;case"tags":R=V?Object(c.jsx)(C,{tags:O.tags,lastUpdated:O.info.last_scraped}):Object(c.jsx)(E,{tab:r});break;case"soundtrack":R=U?Object(c.jsx)(A,{url:O.info.soundtrack.url,lastUpdated:O.info.soundtrack.last_updated}):Object(c.jsx)(E,{tab:r})}return Object(c.jsxs)(z,{children:[Object(c.jsx)("h2",{className:"video-details-title",children:O.info.title}),Object(c.jsx)(b,{videoId:t,tab:r,defaultTab:a,onClickTab:function(e){o(e)},hasSources:B,hasTranscript:M,hasSoundTrack:U,hasTags:V}),R]})},_=function(e){return e.setHeaderOptions(!1),Object(c.jsx)("div",{className:"content-container",children:Object(c.jsx)(V.a,{variant:"warning",children:Object(c.jsx)(V.a.Heading,{children:"Sorry, that page doesn't exist!"})})})},K=function(e){var t,a=n.a.useState(0),s=Object(d.a)(a,2),i=s[0],r=s[1],l=n.a.useRef(null);t=e.numViews>=1e6?(Math.round(e.numViews/1e6*10)/10).toString()+"M":e.numViews>=1e5?Math.round(e.numViews/1e3).toString()+"K":e.numViews>=1e3?(Math.round(e.numViews/1e3*10)/10).toString()+"K":e.numViews.toString();var o,j=v.DateTime.fromISO(e.publishedAt).toRelative(),u=v.Duration.fromISO(e.duration).toFormat("hh:mm:ss"),h="",b=!1,f=Object(g.a)(u);try{for(f.s();!(o=f.n()).done;){var x=o.value;"0"!=x&&":"!=x&&(b=!0),b&&(h+=x)}}catch(w){f.e(w)}finally{f.f()}var m=new ResizeObserver((function(e){r(e[0].target.clientHeight)}));n.a.useEffect((function(){m.observe(l.current)}),[]);var p=100;return i>0&&(p=i-30),Object(c.jsxs)(O.a,{className:"video-card",onClick:function(){e.onClick&&e.onClick(e.id)},children:[Object(c.jsx)(O.a.Img,{ref:l,className:"video-card-img",variant:"top",src:e.thumbnail}),Object(c.jsx)("div",{className:"video-card-duration",style:{top:p},children:h}),Object(c.jsxs)(O.a.Body,{children:[Object(c.jsx)(O.a.Title,{className:"video-card-title",children:e.title}),Object(c.jsx)(O.a.Text,{className:"video-card-info",children:"".concat(t," views | ").concat(j)})]})]})},W=a(50),Y=a.n(W),D=function(e){var t=n.a.useRef(null);t&&t.current||window.scrollTo(0,e.scrollY||0);var a=n.a.useState(e.items||[]),s=Object(d.a)(a,2),i=s[0],r=s[1],l=n.a.useState(0==i.length),o=Object(d.a)(l,2),j=o[0],h=o[1],b=n.a.useState(),O=Object(d.a)(b,2),f=O[0],x=O[1];function v(e){if(t.current&&t.current.firstElementChild){t.current.getClientRects()[0].bottom-(t.current.firstElementChild.clientHeight+100)<=window.innerHeight&&h(!0)}}return n.a.useEffect((function(){if(j){var e={startAt:i.length,maxResults:12};fetch("".concat(I,"/?").concat(Y.a.stringify(e))).then((function(e){return e.json()})).then((function(e){r(i.concat(e)),h(!1)})).catch((function(e){console.error("video feed fetch error",e),x(e)}))}}),[j]),n.a.useEffect((function(){return window.addEventListener("scroll",v),function(){return window.removeEventListener("scroll",v)}}),[]),f&&0==i.length?Object(c.jsx)(L,{title:"There was an error while fetching the video feed!",details:f.message}):Object(c.jsxs)("div",{ref:t,className:"video-feed",children:[i.map((function(t){var a=t.thumbnails.maxresUrl||t.thumbnails.standardUrl||t.thumbnails.highUrl||t.thumbnails.mediumUrl||t.thumbnails.defaultUrl;return Object(c.jsx)("div",{className:"video-feed-card-container",children:Object(c.jsx)(K,{id:t.id,title:t.title,numViews:t.numViews,publishedAt:t.publishedAt,thumbnail:a,duration:t.duration,onClick:function(){return e.onVideoClick&&e.onVideoClick(t.id,i)}})},t.id)})),j&&Object(c.jsx)("div",{className:"video-feed-spinner",children:Object(c.jsx)(u.a,{animation:"border",role:"status",children:Object(c.jsx)("span",{className:"sr-only",children:"Loading..."})})})]})},q=a.p+"static/media/logo.bb2b2928.png",J=a(52),Z=a(51),F=function(e){var t=n.a.useState(!0),a=Object(d.a)(t,2),s=a[0],i=a[1],r=Object(l.g)();function o(e){i((function(e){return window.pageYOffset<100}))}return n.a.useEffect((function(){return window.addEventListener("scroll",o),function(){return window.removeEventListener("scroll",o)}}),[]),Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"header",style:{marginTop:s?0:-70},children:[e.showBack&&Object(c.jsx)("a",{onClick:function(){r.goBack()},className:"header-back",children:Object(c.jsx)(Z.a,{className:"header-back-icon"})}),Object(c.jsxs)("a",{href:"/",className:"header-brand",children:[Object(c.jsx)("img",{className:"header-logo",src:q,alt:"logo"}),Object(c.jsx)("span",{className:"header-logo-text",children:"kurzgesagt-tldr"})]}),Object(c.jsx)("a",{href:"https://github.com/kiwipxl/kurzgesagt-tldr",target:"_blank",className:"header-github",children:Object(c.jsx)(J.a,{className:"header-github-icon"})})]}),e.children]})};function P(e){var t=n.a.useState([]),a=Object(d.a)(t,2),s=a[0],i=a[1],r=n.a.useState(0),o=Object(d.a)(r,2),u=o[0],h=o[1],b=Object(l.g)();return Object(c.jsxs)(l.d,{children:[Object(c.jsx)(l.b,{exact:!0,path:"/",children:Object(c.jsx)(j,{setHeaderOptions:e.setHeaderOptions,children:Object(c.jsx)(D,{items:s,scrollY:u,onVideoClick:function(e,t){i(t),h(window.pageYOffset),b.push("/video/".concat(e))}})})}),Object(c.jsx)(l.b,{path:"/video/:videoId",children:Object(c.jsx)(R,{setHeaderOptions:e.setHeaderOptions})}),Object(c.jsx)(l.b,{path:"/404",children:Object(c.jsx)(_,{setHeaderOptions:e.setHeaderOptions})}),Object(c.jsx)(l.a,{from:"*",to:"/404"})]})}var $=function(){var e=n.a.useState(!1),t=Object(d.a)(e,2),a=t[0],s=t[1];return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(o.a,{basename:"/kurzgesagt-tldr",children:Object(c.jsx)(F,{showBack:a,children:Object(c.jsx)(P,{setHeaderOptions:function(e){s(e)}})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(98);r.a.render(Object(c.jsx)(n.a.StrictMode,{children:Object(c.jsx)($,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[99,1,2]]]);
//# sourceMappingURL=main.53b4601a.chunk.js.map